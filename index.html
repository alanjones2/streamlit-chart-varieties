<!DOCTYPE html>
<html lang="en">

<head>
    <title>Streamlit Supports 5 Important Data Visualization Libraries - Which to Choose?</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta property="og:image" content="./images/rowcharts.png">
    <meta name="twitter:image:src" content="./images/rowcharts.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta property="article:author" content="https://alanjones2.github.io">
    <meta name="twitter:creator" content="@MrAlanJones">
    <meta name="author" content="Alan Jones">


    <meta content="We code examples using Altair, Bokeh, Plotly, Pandas Plot and Matplotlib, to illustrate the pros and cons of each oneubtitle">
    <meta content="https://alanjones2.github.io" property="og:url">
    <meta content="Streamlit Supports 5 Important Data Visualization Libraries - Which to Choose?" property="og:title">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/go.min.js"></script>
    <script>hljs.highlightAll();</script>


    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VDYY6RYRK1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-VDYY6RYRK1');
    </script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3208991186670959"
        crossorigin="anonymous"></script>

    <style>
        blockquote {
            font-style: italic;
            padding-left: 2em;
        }

        img {
            max-width: 90%;
            padding-bottom: 4px;
            padding-top: 4px;
        }
    </style>
</head>

<body class=" bg-white">
    <script>fetch("https://alanjones.pythonanywhere.com/lg?url=alanjones2.github.io/articles/Streamlit Supports 5 Important Data Visualization Libraries - Which to Choose?")
            .then(data => console.log(data));
    </script>
    <a href="https://alanjones2.github.io" style="text-decoration:none">
        <div class="p-2 mb-2 bg-secondary text-white">
            <h1 class="display-6" style="font-weight:bolder">Alan<span style="font-weight:lighter">Jones</span>
                <span class="text-white" style="font-size:50%;font-weight: lighter;"> Coding, Data Science and
                    Data Visualization</span>
            </h1>
        </div>
    </a>

    <div style="margin-top:30px" class="container">

        <div class="row bg-white" style="width: 100%;">

            <div class="col-sm-8 p-2">
                <!-- content-->
                <h1 class="display-4 fw-bold">Streamlit Supports 5 Important Data Visualization Libraries - Which to Choose?</h1>
                <h2 class="lead p-2" style="font-size:xx-large;">We code examples using Altair, Bokeh, Plotly, Pandas Plot and Matplotlib, to illustrate the pros and cons of each oneubtitle</h2>
                <div><img alt="" src="./images/rowcharts.png">
                </div>

                <h1></h1>
<p>Imagine your organisation has decided to use Streamlit as its primary platform for showcasing data visualization applications and, to ensure a consistent look, it wants to adopt a single graphing library to be used across all applications. And, let's say, your job is to investigate which is most appropriate.</p>
<p>You are spoiled for choice! There are 5 libraries you can use for coding your data visualizations: Altair, Bokeh, Plotly, Pyplot (Matplotlib) and Vega Lite. And Streamlit provides some native charts, as well.</p>
<p>Let's take a look at each one and code up some commonly used charts. </p>
<p>The data that we will use is a set of price data for a pair of cryptocurrencies and from that data we will create a line chart showing the change in closing prices over a year for both currencies, a grouped bar chart showing the same data, again, for both currencies and a scatter chart with a trendline showing the correlation between the change in value of the two currencies.</p>
<p>The charts will look similar to the ones in the image above.</p>
<h3>The data</h3>
<p>The dataset we will use is a simple three-column table. It tracks the closing prices of two cryptocurrencies over a 12-month period. It is not important for the exercise but the currencies are Ethereum and Bitcoin and the period is the previous 12 months from the time of writing. (The data are a matter of public record and are available from several sources. I retrieved them from <a href="[Crypto Real Time Prices &amp; Latest News - Yahoo Finance](https://finance.yahoo.com/crypto/)">Yahoo Finance</a>.)</p>
<p>Below is a screenshot of the data that we will use.</p>
<p><img alt="" src="images/crypto-data.png" /></p>
<p>This representation of the data is <em>wide format</em> with each observation (the closing price) in its own column. For this article, this data is assumed to be in the file <em>crypto-23.csv</em> . This wide format shows the different observations (here, the closing prices) in seperate columns (headed ETH and BTC) and is entirely suitable for human readers. However, some data visualization packages require the data to be presented in <em>long</em> format where the observations are in a single column and seperate column contains a label for the observation.</p>
<p>If the data is in the form af a Pandas dataframe (which it is!), we can create a new dataframe in long format using the Pandas <code>melt()</code>function in the following Python code.</p>
<pre><code class="language-python">cryptoL = cryptoW.melt(value_vars=['ETH','BTC'],
          var_name='Name',
          id_vars=['Month'])
</code></pre>
<p>You can look upÂ <code>melt</code>in theÂ <a href="https://pandas.pydata.org/docs/reference/api/pandas.melt.html">Pandas documentation</a> but basically this code creates a new column called <em>Name</em> which contains the values from the original columns <em>ETH</em> and <em>BTC</em>. The <em>Month</em> column remains a single column but it is expanded lengthwise to match <em>Name</em> and the values for the months are repeated as required. The result can be seen in the image below.</p>
<p><img alt="" src="images/crypto-data-long.png" /></p>
<h3>The charts</h3>
<p>More specifically the charts that we want to create are:</p>
<p><em>Line chart</em>: The line chart should track both currencies over the period and show two seperate lines of different colours for each currency.</p>
<p><em>Bar chart</em>: the bar chart should be a grouped bar chart that tracks the two currencies over the period. The bars should be vertical and grouped such that the pair of currencies are shown next to each other in each month. The bar for each curreny should be coloured differently.</p>
<p><em>Scatter chart</em>: The scatter chart should show the relationship between the closing prices of each currency and in addition show include a trendline to indicate the linearity (or otherwise) of that relationship.</p>
<p>Additionally, all charts should have a title and appropriate labels on the x and y axes.</p>
<h3>The options</h3>
<p>First, let's do a quick review of the options so we can eliminate any obvious non-starters.</p>
<p><strong>Streamlit charts</strong></p>
<p>The first thing we should look at is the set of built-in functions that Streamlit provides. They will draw simple line charts, bar charts and scatter plots. And, as the documentation states, these are simply wrappers around the Altair equivalents. The documentation also suggests that if these simple charts don't work for you, you should use the Altair charts, instead.</p>
<p>A quick look at the documentation will confirm that these charts cannot produce any of the three charts in this exercise as they cannot display more than one trace per chart. We won't explore these any further.</p>
<p><strong>Vega-Lite</strong></p>
<p>Vega-Lite is a powerful graphing language that specifies charts in a JSON format [1]. Writing a Vege-Lite specification can be an arduous and error-prone task which is why Altair was developed. Altair is a Python library that outputs Vega-Lite specs, so If you already have Vega-Lite specifications to hand then the Vega-Lite library is the obvious one to use. But to create a chart from scratch it has to be better to use the Altair library which is a Python-friendly way of producing the same thing.</p>
<p><strong>The rest</strong></p>
<p>The remaining libraries are all powerful and Python-friendly ways of producing sophisticated charts and we will explore them further. But we'll look at one of the libraries in two ways.'</p>
<p>Streamlit's <code>st.pyplot()</code>function is a way of displaying Matplotlib figures but, of course, there are other plotting libraries that are built on Matplotlib: Seaborn, Plotnine and Pandas Plots, for example. To show how we can use these we will include a version of the graphs created with Pandas Plots in addition to those created directly in Matplotlib.</p>
<p>So, we will create the three graphs in each of Altair, Bokeh, Matplotlib, Pandas Plots and Plotly.</p>
<h3>Altair</h3>
<p>Altair[3] is a graphing library based on the concept of the Grammar of Graphics [2]. Instead of implementing specific chart types, with Altair you start with the data and then decide how that data should be mapped onto the various aspects of a graphical representation. (For a more detailed look at Altair, please see my article <a href="https://medium.com/towards-data-science/altair-and-the-powerful-vega-lite-grammar-of-graphics-d1d864c3e08e">Mastering Data Visualizaton with Altairâ€™s Grammar of Graphics</a>.)</p>
<p>To implement the three graphs we first need to included the libraries and import the data.</p>
<pre><code class="language-python">import streamlit as st
import pandas as pd
import altair as alt

cryptoW = pd.read_csv(&quot;crypto-23.csv&quot;)
cryptoL = cryptoW.melt(value_vars=['ETH','BTC'],
          var_name='Name',id_vars=['Month'])
</code></pre>
<p>We import the Streamlit package, of course, along with Pandas and Altair. The data is in a <em>CSV</em> file and, as you can see we import the <em>wide</em> version in <code>cryptoW</code>,  and then create a <em>long</em> version of the data in the variable <code>cryptoL</code>.</p>
<p>To create any Altair chart we start with the code <code>alt.Chart()</code>, pass it the data and then map the data onto the various parts of the chart. The code for the line chart follows.</p>
<pre><code class="language-python">fig = alt.Chart(cryptoL, 
                width=800, 
                title='Cryptocurrency closing prices'
                ).mark_line().encode(
                    x = 'Month:O',
                    y = 'value:Q',
                    color = 'Name:N')

st.altair_chart(fig)
</code></pre>
<p>We specify the dataframe that we are going to use as a parameter (there are other parameters that we could include, here we set the title and width). The <code>mark_line()</code> method specifies that we want the data represented as a line and the encodings that follow determine the way the data is mapped onto the chart: the month is on the <code>x</code> axis, the value on the <code>y</code>axis and the <code>color</code>is specified by the name of the currency. Note that the codes appended to the names of the data fields are Altair types, <code>O</code>is ordinal, <code>Q</code>is qualitative and <code>N</code>is nominal.</p>
<p>The resulting graph is shown below. (In this rendition, the text is not very easy to see but the title, x and y label and the legend are perfectly visible in the Streamlit app).</p>
<p><img alt="" src="images/alt-line.png" /></p>
<p>So, tick! That's our first graph completed. Let's do the other two.</p>
<p>The grouped bar chart code is very similar. This time we use the method <code>mark_bar</code>. Without any modification this will gives is a stacked bar chart but by specifying an x offset, we can shift the bars sideways and thereby produce a grouped chart.</p>
<pre><code class="language-python">fig = alt.Chart(cryptoL, 
                width=800,
                title='Cryptocurrency closing prices'
                ).mark_bar().encode(
                    x = 'Month:O',
                    y = 'value:Q',
                    color = 'Name:N',
                    xOffset = 'Name:N')

st.altair_chart(fig)
</code></pre>
<p>You can see the result below (the earler comment applies to the text here, too).</p>
<p><img alt="" src="images/alt-bar.png" /></p>
<p>The scatter chart is slightly more complicated because we want to include a trendline</p>
<p>The code below is very similar to the other charts but here we use the wide form of the data and the method <code>mark_point()</code>. The x and y data are the two currencies.</p>
<pre><code class="language-python">fig = alt.Chart(cryptoW, 
                width=800,
                title='Cryptocurrency closing prices'
                ).mark_point().encode(
                    x = 'BTC',
                    y = 'ETH')
</code></pre>
<p>As it stands that code would be sufficient to draw a scatter chart. To add the trendline we need to do a little more work.</p>
<pre><code class="language-python">trend = fig.transform_regression('BTC', 'ETH').mark_line()
</code></pre>
<p>Altair has built-in transfom functions and here we use the function <code>transform_regression()</code>to create a line chart of <code>ETH</code>versus <code>BTC</code>.</p>
<p>To combine the two charts we simply 'add' them together.</p>
<pre><code class="language-python">st.altair_chart(fig + trend)
</code></pre>
<p>The <code>+</code> operator combines the two graphs placing one on top of the other resulting in the following chart.</p>
<p><img alt="" src="images/alt-scatter1.png" /></p>
<p>That is correct but not ideal. It would be better if we could ignore the left side of the chart that is blank. We can fix this with the longer version shown below.</p>
<pre><code class="language-python">fig = alt.Chart(cryptoW, 
                width=800,
                title='Cryptocurrency closing prices'
                ).mark_point().encode(
                    x = alt.X('BTC',scale=alt.Scale(domain=[20000, 70000])),
                    y = 'ETH')

trend = fig.transform_regression('BTC', 'ETH').mark_line()

st.altair_chart(fig + trend)
</code></pre>
<p>This is fundamentall the same chart but we have specified the x axis in a different way (using the <code>alt.X()</code> function). By doing this we can pass values for the scale and here we specifiy thay the x scale should begin at 20000 and end at 70000. This code gives us a better rendition.</p>
<p><img alt="" src="images/alt-scatter2.png" /></p>
<p>We have completed the first task. Altair has givens us perfectly good charts with not too much effort.</p>
<h3>Bokeh</h3>
<p>The Bokeh library has a similar feel to Altair in that it starts with  a figure object and builds the chart chat that. But the figure specifies mostly decorative elements of the chart. The graphical elements are built on topp as attributes to the figure object.</p>
<p>Here's the initial code that imports the library and the data.</p>
<pre><code class="language-python">import streamlit as st
import pandas as pd
from bokeh.plotting import figure

cryptoW = pd.read_csv(&quot;crypto-23.csv&quot;)
</code></pre>
<p>Now we add a figure with some textual attributes.</p>
<pre><code class="language-python">p = figure(title=&quot;Line chart ETH and BTC prices&quot;, 
          x_axis_label=&quot;Month&quot;, 
          y_axis_label=&quot;Value (USD)&quot;)
</code></pre>
<p>To this initial figure we can add graphical elements such as lines. The next piece of code adds line graphs for the two currencies.</p>
<pre><code class="language-python">p.line(cryptoW['Month'], 
    cryptoW['BTC'], 
    legend_label=&quot;BTC&quot;, 
    color = 'blue',
    line_width=2)
p.line(cryptoW['Month'], 
    cryptoW['ETH'], 
    legend_label=&quot;ETH&quot;, 
    color = &quot;green&quot;,
    line_width=2)
p.legend.location = &quot;top_left&quot;

st.bokeh_chart(p)
</code></pre>
<p>As you can see the <code>line()</code>function is invoked twice for each of the currencies (with appropriate labels, colours and line width) and we (optionally) change the default position of the legend to the top left so that it doesn't obscure the lines in the graph.</p>
<p>Below we can see the resulting graph.</p>
<p><img alt="" src="images/bokeh_line.png" /></p>
<p>The result is, of course, similar to the Altair version but with a slightly different style.</p>
<p>The grouped bar chart is very similar but uses the <code>vbar()</code>function to plot the data, and like the Altair version would default to a stacked bar. With Bokeh we can use <code>dodge()</code>as a parameter which shifts the bars horizontally. First, we set a width for the bars (a full bar would have a width of 1 but since there are two bars they should be a maximum of 0.5 each. Here we set them to 0.4 so there is a gap between them). We then we use the width divided by 2 to set the offset for each bar.  </p>
<pre><code class="language-python">from bokeh.transform import dodge
p = figure(title=&quot;Grouped bar&quot;, 
          x_axis_label=&quot;Month&quot;, 
          y_axis_label=&quot;Value (USD)&quot;)
width = 0.4

p.vbar(
    x=dodge(&quot;Month&quot;,width/2), 
    legend_label=&quot;BTC&quot;,
    top=&quot;BTC&quot;,
    width=width,
    source=cryptoW,
    color='blue'
)
p.vbar(
    x=dodge(&quot;Month&quot;,-width/2), 
    legend_label=&quot;ETH&quot;,
    top=&quot;ETH&quot;,
    width=width,
    source=cryptoW,
    color='green'
)
p.legend.location = &quot;top_left&quot;
st.bokeh_chart(p)
</code></pre>
<p>The chart is show below.</p>
<p><img alt="" src="images/bokeh_bar.png" /></p>
<p>Finally, we need to draw the scatter plot. We start by defining the figure as before and then creating a simple scatter plot.</p>
<pre><code class="language-python">p = figure(title=&quot;Scatter chart BTC/ETH&quot;, 
          x_axis_label=&quot;BTC&quot;, 
          y_axis_label=&quot;ETH&quot;,
          width=800)

p.circle(cryptoW['BTC'], cryptoW['ETH'], size=8) 
</code></pre>
<p>We set the point size in the scatter plot to 0.8 which is appropriate for this chart. And then we create a line chart which is the trendline. We create the trendline using Numpy to determine the cooefficients for a first level regression plot and then create a new column in the dataframe from that.</p>
<pre><code class="language-python"># Add trend line to scatter plot
import numpy as np
# Calculate regression params
m,b = np.polyfit(cryptoW.BTC, cryptoW.ETH, 1)

# Add a trendline to the dataframe
cryptoW[&quot;trendline&quot;] = [y for  y in  m*cryptoW.BTC + b]

p.line(cryptoW['BTC'], 
      cryptoW['trendline'],  
      color = &quot;green&quot;,
       line_width=2)

st.bokeh_chart(p)
</code></pre>
<p>When this line is added to the chart we get the following figure.</p>
<p><img alt="" src="images/bokeh_scatter.png" /></p>
<p>Again, a pefectly adequate chart.</p>
<h3>Matplotlib</h3>
<p>Like many libraries, Matplotlib gives us a set of basic chart types to choose from and then provides a set of functions that can modify that chart.</p>
<p>Matplotlib requires you to engage with your charts at a fairly low level but in doing this gives you a lot of control over the result.</p>
<p>For Matplotlib we will use only the wide format data. Here's the intial code.</p>
<pre><code class="language-python">import streamlit as st
import pandas as pd
import matplotlib.pyplot as plt

cryptoW = pd.read_csv(&quot;crypto-23.csv&quot;)
</code></pre>
<p>And let's see the code for the line chart.</p>
<pre><code class="language-python">fig, ax = plt.subplots()

ax.plot(cryptoW['Month'], cryptoW['BTC'])
ax.plot(cryptoW['Month'], cryptoW['ETH'])
plt.xlabel(&quot;Month&quot;)
plt.ylabel(&quot;Closing value (USD)&quot;)
plt.title(&quot;BTC/ETH performance&quot;)
plt.legend(['BTC','ETH'])
st.pyplot(fig)
</code></pre>
<p>We first define a Matplotlib plot in the first line of code. This gives us two variables that will contain the final figure and the axes that are elements of that figure.</p>
<p>I hope you can see that using Matplotlib we simply build a plot with a series of statements. First, we create the line plots for the two currencies (the Matplotlib functio <code>plot()</code>creates a line plot for the x and y data provided).</p>
<p>And following that, we specifiy the textual properties of the plot and the legend.</p>
<p>The line plot is shown below.</p>
<p><img alt="" src="images/plt-line.png" /></p>
<p>The bar chart is very similar. In the code below we specify the width of a bar and set the individual to that width but shifting it horizontally by adding or subtracting half of the column width. This gives us the grouped chart that we want and is a similar technique to the ones we've seen earlier.</p>
<pre><code class="language-python">fig, ax = plt.subplots()
width = 0.45
ax.bar(cryptoW['Month']-width/2, cryptoW['BTC'], width=width)
ax.bar(cryptoW['Month']+width/2, cryptoW['ETH'], width=width)
plt.xlabel(&quot;Month&quot;)
plt.ylabel(&quot;Closing value (USD)&quot;)
plt.title(&quot;BTC/ETH performance&quot;)
plt.legend(['BTC','ETH'])
st.pyplot(fig)
</code></pre>
<p>The result can be seen below.</p>
<p><img alt="" src="images/plt-bar.png" /></p>
<p>A next, of course, the scatter diagram.</p>
<p>Again the code is similar to create the initial scatter plot. After that, we determine the cooeficients for a regression line with Numpy (as above) and create a trendline column in the dataframe. A line plot is created from that trendline and added to the figure.</p>
<pre><code class="language-python">fig, ax = plt.subplots()
ax.scatter(cryptoW['BTC'], cryptoW['ETH'])
plt.xlabel(&quot;BTC&quot;)
plt.ylabel(&quot;ETH&quot;)
plt.title(&quot;BTC/ETH correlation&quot;)

import numpy as np
m,b = np.polyfit(cryptoW.BTC, cryptoW.ETH, 1)

# Add a trendline to the dataframe
cryptoW[&quot;trendline&quot;] = [y for  y in  m*cryptoW.BTC + b]
st.table(cryptoW)

ax.plot(cryptoW['BTC'], cryptoW['trendline'])

plt.xlabel(&quot;BTC&quot;)
plt.ylabel(&quot;ETH&quot;)
plt.title(&quot;BTC/ETH correlation&quot;)
st.pyplot(fig)
</code></pre>
<p>The resulting figure is shown below.</p>
<p><img alt="" src="images/plt-scatter.png" /></p>
<p>Matplotlib is a fairly low level charting package and other, higher level, packages have been created on top of this library and we will look at one of these next.</p>
<h3>Pandas Plots</h3>
<p>Pandas incorporates plotting functions and it is simply a matter of using the appropriate method on a dataframe to create a chart.</p>
<p>The initial code is the same as Matplotlib because we are using exactly the same packages.</p>
<pre><code class="language-python">import streamlit as st
import pandas as pd
import matplotlib.pyplot as plt

cryptoW = pd.read_csv(&quot;crypto-23.csv&quot;)
</code></pre>
<p>And we also need to define the <code>fig</code>and <code>ax</code>variables in the same way as we did with Mathplotlib. Below is the code to produce a line chart for just the ETH prices.</p>
<pre><code class="language-python"># ETH line chart
fig, ax = plt.subplots()
cryptoW.plot(y='ETH', x='Month', title='ETH values', ax=ax)
st.pyplot(fig)
</code></pre>
<p>You can see that we call a method on the dataframe itself <code>plot()</code>, this will produce a line chart from the parameters given. Note that it is importand that we refer to the <code>ax</code> variable in the call - this effectively adds the new line plot to the figure that we defined at the beginning.</p>
<p>With Pandas Plots we can specify any number of <code>y</code>variabes by passing a list as a parameter. So, to plot a line chart for both ETH and BTC the code is almost identical.</p>
<pre><code class="language-python">fig, ax = plt.subplots()
cryptoW.plot(y=['BTC','ETH'], x='Month',
             title='BTC and ETH values', ax=ax)
st.pyplot(fig)
</code></pre>
<p>This code is a little shorter than the Matplotlib code as Pandas makes assumptions about the names of the axes - it takes them from the column name by default although you can change this if you wish. The line chart is shown below.</p>
<p><img alt="" src="images/pyplot-line.png" /></p>
<p>The grouped bar code is alsmost identical except for the name of the method to be called; here it is <code>plot.bar()</code>rather than simply <code>plot()</code>.</p>
<pre><code class="language-python">fig, ax = plt.subplots()
cryptoW.plot.bar(y=['BTC','ETH'], x='Month', 
                 title='BTC and ETH values', ax=ax)
st.pyplot(fig)
</code></pre>
<p>We don't need to mess around with the positioning of the bars in order to create a grouped set of bars, Pandas defaults to creating a grouped representation when given a list of <code>y</code>values.</p>
<p><img alt="" src="images/pyplot-bar.png" /></p>
<p>To create a simple scatter plot we use the method <code>plot.scatter()</code>and otherwise the code is very similar to the other charts. However, to add the trendline we need to create a seperate plot.</p>
<p>Below is the code to create the basic scatter plot.</p>
<pre><code class="language-python">fig, ax = plt.subplots()
ax = cryptoW.plot.scatter(y='ETH', x='BTC', 
                          title='BTC and ETH values', ax=ax)
st.pyplot(fig)
</code></pre>
<p>As you see it is agin very similar to the preceding code. To add the trendline we create a new column in the dataframe as we did previously.</p>
<pre><code class="language-python">m,b = np.polyfit(cryptoW.BTC, cryptoW.ETH, 1)

# Add a trendline to the dataframe
cryptoW[&quot;trendline&quot;] = [y for  y in  m*cryptoW.BTC + b]
</code></pre>
<p>Now we can plot a line form this new column and by including the existing axis <code>ax</code>, we add this new plotline to the existing figure. </p>
<pre><code class="language-python">cryptoW.plot(x = 'BTC', y = 'trendline', ax=ax)
st.pyplot(fig)
</code></pre>
<p>And when we plot the figure we get the scatter plot with the trendline as we see below.</p>
<p><img alt="" src="images/pyplot-scatter.png" /></p>
<p>Pandas plots gives you all of the flexibility of Matplotlib as you can still use the Matplotlib lobrary to modify the figure using the <code>plt.*</code>methods but the syntax for plotting is a little cleaner when using a Pandas dataframe as the source of the plotting data.</p>
<h3>Plotly</h3>
<p>Plotly has both high level and low level functions - Plotly Express is the recommended library as it incorporates a large number of standard charts, whereas lower level functions are provided by the Plotly Graphic Objects (GO) part of the package. Plotly, themselves, suggest that you use Plotly Express, which is built upon Plotly GO, and that is what we will do.</p>
<p>Plotly is generally better used with long format data, so our initial code includes the generation of this form of the data.</p>
<pre><code class="language-python">import streamlit as st
import pandas as pd
import plotly.express as px

cryptoW = pd.read_csv(&quot;crypto-23.csv&quot;)
cryptoL = cryptoW.melt(value_vars=['ETH','BTC'],
                       var_name='Name',id_vars=['Month'])
</code></pre>
<p>Creating a line chart from the long data is achieved in a single line of code. Below we see that line and how it is plotted.</p>
<pre><code class="language-python">fig = px.line(cryptoL, x=&quot;Month&quot;, y=&quot;value&quot;, 
              color='Name', title='BTC and ETH values')
st.plotly_chart(fig))
</code></pre>
<p>By specifiying the <code>y</code>value to be the <code>value</code>column we tell the function which data to use for the line chart and by including the <code>color</code> parameter, we ensure that we have seperate coloured lines (in this case one for each name). We set the name of the figure as a parameter - the axis labels are taken care of automatically.</p>
<p><img alt="" src="images/plotly-line.png" /></p>
<p>The bar graph is equally easy and follows the same pattern. The default bar chart is a stacked one but we simply set the <code>barmode</code> parameter to <code>'group'</code>to get the grouped representation.</p>
<p>Again we create the figure in a single line of code.</p>
<pre><code class="language-python">fig = px.bar(cryptoL, x=&quot;Month&quot;, y=&quot;value&quot;, color=&quot;Name&quot;, 
             barmode='group', title='BTC and ETH values')
st.plotly_chart(fig)
</code></pre>
<p>And the resulting figure is shown below.</p>
<p><img alt="" src="images/plotly-bar.png" /></p>
<p>When is comes to the scatter chart, Plotly provides built in trendline functionality. This require the inclusion of the <em>statsmodels</em> library which, while not imported, must be installed.</p>
<pre><code class="language-python">fig = px.scatter(cryptoW, x=&quot;ETH&quot;, y=&quot;BTC&quot;, 
                 trendline=&quot;ols&quot;, title='ETH/BTC values')
st.plotly_chart(fig)
</code></pre>
<p>In the code above we see the familar pattern of a Plotly plot - and additional parameter <code>trendline</code>  will ensure that the regression line is calculated and drawn with no effort on the preogrammer's part.</p>
<p><img alt="" src="images/plotly-scatter.png" /></p>
<p>That completes the set of charts for Plotly and for the whole exercise.</p>
<h3>So, where does that leave us</h3>
<p>In terms of what the charts shows us, the line and bar charts illustrate the prices for these cryptocurrencies being pretty volatile and the scatter charts confirm what we can also see in the other charts that the two currencies tend to go up and down together - general sentiment about cryptocurrencies probably affects the value of most, if not all, of them.</p>
<p>But what about the libraries.</p>
<p>All of the libraries do a reasonable job although you find some charts more attractive than others - the Matplotlib charts look a little more clunky than the others, for example (although this may mainly to do with the large font which can be easily changed with a little extra code, for example, <code>matplotlib.rcParams['font.size'] = 8</code> will reduce the size of all off the text in a figure and this being a global setting will affect all plots that are created after it is executed).</p>
<p>With a little effort you can customize any of the charts that we've looked at either by adjusting particular aspcts of a plot such as the height and width, or by adopting a different style sheet.</p>
<p>What is important ot the programmer, of course, is the ease with which you can code these figures. It's fair to say that the library that has the most compact code is Plotly Express, followed closely by Pandas Plots. With Altair, Bokeh and Matplotlib you need to do a little more work though working with any of the packages is fairly straightforward.</p>
<p>Another thing that might  sway your decision is the philosophy behind the libraries. </p>
<p>Altair uses a Grammar of Graphics approach where you decide what you want to do with the data, whereas the others tend to favour solutions to standard problems by including a fixed library of chart types.</p>
<p>Matplotlib makes you build your charts from the bottom up and has a whole bunch of methods for adjusting and customizing graphs. Pandas Plots simplifies the Matplotlib approach but maintains its flexibility -  Matplotlib parameters and functions work with Pandas charts, too.</p>
<p>Bokeh, again, provides a lot of flexibility with the downside that you need to write more code than in other libraries.</p>
<p>Plotly, last but not least, provides a large number of fixed chart types and they are each customizable. If compact code is important then Plotly is probably the winner in this respect.</p>
<p>The decision is yours (or your organisation's). I could have simply stated my own preference at the beginning but the purpose of showing you the code is so you cab judge for yourself.</p>
<hr />
<p>Thanks for reading and I hope this has been helpful. You can find all of the above code and data in the <a href="[streamlit-chart-varieties/code at main Â· alanjones2/streamlit-chart-varieties Â· GitHub](https://github.com/alanjones2/streamlit-chart-varieties/tree/main/code)">GitHub repo</a> for this article in the form of Streamlit programs. Feel free to download them for your reference.</p>
<h3>Notes</h3>
<ol>
<li>
<p><a href="http://vis.csail.mit.edu/pubs/vega-lite">Vega-Lite: A Grammar of Interactive Graphics</a>, Arvind Satyanarayan, Dominik Moritz, Kanit Wongsuphasawat and Jeffrey Heer,Â <em>IEEE Transactions on Visualization &amp; Computer Graphics (Proc. IEEE InfoVis)</em>, 2017</p>
</li>
<li>
<p>Leland Wilkinson's seminal, The Grammar of Graphics (Statistics and Computing) 2nd Edition (2005), is listed onÂ <a href="https://amzn.to/3HVR3mS">Amazon</a>. Itâ€™s not cheap!</p>
</li>
<li>
<p><a href="https://joss.theoj.org/papers/10.21105/joss.01057">Altair: Interactive Statistical Visualizations for Python</a>, Jacob VanderPlas, et al. _Journal of Open Source Software, 3(32), 1057</p>
</li>
</ol>
<p><em>Links to Amazon are affiliate links which means if you purchase something I may get a small commission but it will not affect the price you pay</em></p>
<p>All images and screenshots are by me, the author, unless otherwise noted.</p>
            </div>
            <div class="col-sm-3 p-2">
                <!--ads etc here -->
                <!-- streamlit from scratch-->
                <div class="p-4 shadow-sm mb-4 rounded border border-secondary bg-light">
                    <div>
                        <i>eBook</i>
                        <img class="mr-3" src="" width='80%' height='auto' alt="">
                        <h5>
                            <a href="https://alanjones2.github.io/streamlitfromscratch/" target="_blank">
                                <span class="text-dark">Streamlitfrom Scratch</span>
                            </a>
                        </h5>
                        <p><b>Streamlit</b> is a framework for creating Data Science apps in Python.
                            <br />
                            <b>Streamlit from Scratch</b> is an ebook that will teach you how to get started with
                            Streamlit.
                        </p>
            
                    </div>
                </div>
            
                <!-- google add start-->
                <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3208991186670959"
                    crossorigin="anonymous"></script>
                <!-- sfs vertical -->
                <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3208991186670959" data-ad-slot="6617299104"
                    data-ad-format="auto" data-full-width-responsive="true"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
                <!-- google add end-->
            
            
                <!-- how charts work-->
                <div class="p-4 shadow-sm mb-4 rounded border border-secondary bg-light">
                    <div>
                        <i>Sponsored content</i>
                        <img class="mr-3" src="https://m.media-amazon.com/images/I/61y5lxsc9DL._SY466_.jpg" width='80%'
                            height='auto' alt="">
                        <h5 class="mt-0">
                            <a href="https://amzn.to/47FKuiz" target="_blank">
                                <span class="text-dark">How Charts Work: Understand and explain data with
                                    confidence</span>
                            </a>
                        </h5>
                        <h6>From the Back Cover</h6>
                        <p>
                            How Charts Work brings the secrets of effective data visualisation in a way that will
                            help you bring data alive.
                            Charts, graphs and tables are essential devices in business, but all too often they
                            present information poorly.
                            This
                            book will help you:
            
                            <li>Feel confident understanding different types of charts, graphs and tables – and how
                                to read them</li>
                            <li>Recognise the true story behind the data presented and what the information really
                                shows</li>
                            <li>Know the principles and rules of how best to represent information so you can create
                                your own
                                information-driven (and
                                beautiful) visuals</li>
                            <li>Design visuals that people engage with, understand and act upon</li>
                        </p>
            
                    </div>
                </div>
                <!-- google add start-->
                <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3208991186670959"
                    crossorigin="anonymous"></script>
                <!-- sfs vertical -->
                <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3208991186670959" data-ad-slot="6617299104"
                    data-ad-format="auto" data-full-width-responsive="true"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
                <!-- google add end-->
            
                <!-- the art of statistics-->
                <div class="p-4 shadow-sm mb-4 rounded border border-secondary bg-light">
                    <div>
                        <i>Sponsored content</i>
                        <img class="mr-3" src="https://m.media-amazon.com/images/I/61eFjiH7sIL._SY264_BO1,204,203,200_QL40_ML2_.jpg"
                            width='80%' height='auto' alt="">
                        <h5 class="mt-0">
                            <a href="https://amzn.to/3kVBGmo" target="_blank">
                                <span class="text-dark">The Art of Statistics: How to Learn from Data</span>
                            </a>
                        </h5>
                        Discover how data literacy is changing the world and gives you a better understanding of
                        life's biggest problems. I have used this book in various articles and found it to be
                        invaluable.
            
                    </div>
                </div>
            
                <!-- google add start-->
                <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3208991186670959"
                    crossorigin="anonymous"></script>
                <!-- sfs vertical -->
                <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3208991186670959" data-ad-slot="6617299104"
                    data-ad-format="auto" data-full-width-responsive="true"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
                <!-- google add end-->
            
                <div class="p-4 shadow-sm mb-4 rounded border border-secondary bg-light">
            
                    <i>eBook</i>
                    <h5><a href='https://alanjones.gumroad.com/l/auiws' target='_blank'>Plotting with Pandas</a>
                    </h5>
                    <p>
                        <b>Plotting with Pandas: an Introduction to Data Visualization</b> is an ebook that covers basic and
                        statistical plots using Python and Pandas, line and bar charts, scatter plots, pie charts,
                        histograms, box plots, etc.
                    </p>
            
            
            
                </div>
            
                <!-- google add start-->
                <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3208991186670959"
                    crossorigin="anonymous"></script>
                <!-- sfs vertical -->
                <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3208991186670959" data-ad-slot="6617299104"
                    data-ad-format="auto" data-full-width-responsive="true"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
                <!-- google add end-->
            
                <!-- storytelling in data-->
                <div class="p-4 shadow-sm mb-4 rounded border border-secondary bg-light">
                    <div>
                        <i>Sponsored content</i>
                        <img class="mr-3" src="https://m.media-amazon.com/images/I/41OonY0kRWL._SX399_BO1,204,203,200_.jpg"
                            width='80%' height='auto' alt="">
                        <h5 class="mt-0">
                            <a href="https://amzn.to/3JmzEFq" target="_blank">
                                <span class="text-dark">Storytelling with Data: A Data Visualization Guide for
                                    Business</span>
                            </a>
                        </h5>
                        Don't simply show your data - tell a story with it! Storytelling with Data teaches you
                        the fundamentals of data visualization and how to communicate effectively with data. I
                        use this book in the series of articles '12 Essential Visualizations and How to
                        Implement them.
            
                    </div>
                </div>
            
                <!-- google add start-->
                <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3208991186670959"
                    crossorigin="anonymous"></script>
                <!-- sfs vertical -->
                <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3208991186670959" data-ad-slot="6617299104"
                    data-ad-format="auto" data-full-width-responsive="true"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
                <!-- google add end-->
            
                <!-- How charts lie -->
                <div class="p-4 shadow-sm mb-4 rounded border border-secondary bg-light">
                    <div>
                        <i>Sponsored content</i>
                        <img class="mr-3" src="https://m.media-amazon.com/images/I/41N21MzfCRL._SX329_BO1,204,203,200_.jpg"
                            width='80%' height='auto' alt="">
                        <h5 class="mt-0">
                            <a href="https://amzn.to/3ZuQO9B" target="_blank">
                                <span class="text-dark">How Charts Lie: Getting Smarter about Visual
                                    Information</span>
                            </a>
                        </h5>
                        A leading data visualization expert explores the negative - and positive - influences
                        that charts have on our perception of truth. I used this book as the inspiration for
                        'How Not to Lie with Charts'.
            
                    </div>
                </div>
            
            
                <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3208991186670959"
                    crossorigin="anonymous"></script>
                <!-- sfs vertical -->
                <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3208991186670959" data-ad-slot="6617299104"
                    data-ad-format="auto" data-full-width-responsive="true"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            
                <div id="amzn-assoc-ad-d5bf4dcd-55c6-4038-a3d8-ff8bfa49de8a"></div>
                <script async
                    src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&adInstanceId=d5bf4dcd-55c6-4038-a3d8-ff8bfa49de8a"></script>
            
            </div>
        </div>




        <div style="margin: 20px;">
            <script async
                src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3208991186670959"
                crossorigin="anonymous"></script>
            <!-- alanjonescoding_ads_AdSense1_1x1_as -->
            <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3208991186670959"
                data-ad-slot="2622033521" data-ad-format="auto" data-full-width-responsive="true"></ins>
            <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
            <footer class="text-right text-secondary">
                <i>Please note that all the software in these articles is written for educational purposes and should
                    not be
                    considered suitable for production code</i>
                <br />
                <i>This site may contain affliate links. If you purchase an item through such a link I may get a
                    commision
                    but at no cost to you. As an Amazon Associate, I earn from qualifying purchases.</i>
                <br />
                <i>&copy; 2024, Alan Jones</i> &nbsp;

            </footer>
        </div>
    </div>

</body>

</html>